!function(){"use strict";function e(e,t){return document.currentScript.getAttribute("data-"+e)||t}var t=e("page-url",window.location.href.replace(/#.*$/,"")),o=e("add-urls",void 0),n=e("data-id","webmentions"),r=e("wordcount"),a=e("max-webmentions",30),i=e("prevent-spoofing")?"wm-source":"url",s=e("sort-by","published"),u=e("sort-dir","up"),l={"in-reply-to":"replied","like-of":"liked","repost-of":"reposted","bookmark-of":"bookmarked","mention-of":"mentioned",rsvp:"RSVPed","follow-of":"followed"},c={"in-reply-to":"💬","like-of":"❤️","repost-of":"🔄","bookmark-of":"⭐️","mention-of":"💬",rsvp:"📅","follow-of":"🐜"},f={yes:"✅",no:"❌",interested:"💡",maybe:"💭"};function p(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function h(e){var t='<a class="reaction" rel="nofollow ugc" title="'+p(e.author&&e.author.name?e.author.name:e.url.split("/")[2])+" "+(l[e["wm-property"]]||"reacted")+'" href="'+e[i]+'">';return e.author&&e.author.photo&&(t+='<img src="'+p(e.author.photo)+'">'),t+=c[e["wm-property"]]||"💥",e.rsvp&&f[e.rsvp]&&(t+="<sub>"+f[e.rsvp]+"</sub>"),t+="</a>"}function m(e){return e.substr(e.indexOf("//"))}function d(e){var t=[],o={};return e.forEach((function(e){var n=m(e.url);o[n]||(t.push(e),o[n]=!0)})),t}window.addEventListener("load",(function(){var e=document.getElementById(n);if(e){var l=[m(t)];o&&o.split("|").forEach((function(e){l.push(m(e))}));var c="https://webmention.io/api/mentions.jf2?per-page="+a+"&sort-by="+s+"&sort-dir="+u;l.forEach((function(e){c+="&target[]="+encodeURIComponent("http:"+e)+"&target[]="+encodeURIComponent("https:"+e)})),function(e,t){if(window.fetch)window.fetch(e).then((function(e){return e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject(new Error(e.statusText))})).then((function(e){return e.json()})).then(t).catch((function(e){console.error("Request failed",e)}));else{var o=new XMLHttpRequest;o.onload=function(e){t(JSON.parse(e))},o.onerror=function(e){console.error("Request failed",e)}}}(c,(function(t){var o="",n=[],a=[],s={"in-reply-to":n,"like-of":a,"repost-of":a,"bookmark-of":a,"mention-of":n,rsvp:n};t.children.forEach((function(e){var t=s[e["wm-property"]];t&&t.push(e)})),n.length>0&&(o+=function(e){var t="<h2>"+e.length+" Response"+(e.length>1?"s":"")+'</h2><ul class="comments">';return e.forEach((function(e){var o,n;if(t+="<li>",t+=h(e),t+=' <a class="source" rel="nofollow ugc" href="'+e[i]+'">',e.author&&e.author.name?t+=p(e.author.name):t+=p(e.url.split("/")[2]),t+="</a>: ",e.name)o="name",n=e.name;else if(e.content&&e.content.text){var a=p(e.content.text);if(r){var s=a.replace(/\s+/g," ").split(" ",r+1);s.length>r&&(s[r-1]+="&hellip;",a=(s=s.slice(0,r)).join(" "))}o="text",n=a}else o="name",n="(mention)";t+='<span class="'+o+'">'+n+"</span>",t+="</li>"})),t+="</ul>"}(d(n))),a.length>0&&(o+=function(e){var t="<h2>"+e.length+" Reaction"+(e.length>1?"s":"")+'</h2><ul class="reacts">';return e.forEach((function(e){t+=h(e)})),t}(d(a))),e.innerHTML=o}))}}))}();