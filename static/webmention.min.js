!function(){"use strict";window.i18next=window.i18next||{t:function(t){return t}};const t=window.i18next.t.bind(window.i18next);function n(t,n){return document.currentScript.getAttribute("data-"+t)||n}const e=n("page-url",window.location.href.replace(/#.*$/,"")),o=n("add-urls",void 0),r=n("id","webmentions"),s=n("wordcount"),i=n("max-webmentions",30),l=n("prevent-spoofing")?"wm-source":"url",c=n("sort-by","published"),a=n("sort-dir","up"),u=n("comments-are-reactions"),p={"in-reply-to":t("replied"),"like-of":t("liked"),"repost-of":t("reposted"),"bookmark-of":t("bookmarked"),"mention-of":t("mentioned"),rsvp:t("RSVPed"),"follow-of":t("followed")},f={"in-reply-to":"💬","like-of":"❤️","repost-of":"🔄","bookmark-of":"⭐️","mention-of":"💬",rsvp:"📅","follow-of":"🐜"},d={yes:"✅",no:"❌",interested:"💡",maybe:"💭"};function m(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function h(n,e){const o=m(n.author?.name??n.url.split("/")[2]);let r=p[n["wm-property"]]||t("reacted");!e&&n.content&&n.content.text&&(r+=": "+g(n));let s="";n.author&&n.author.photo&&(s=`\n        <img\n          src="${m(n.author.photo)}"\n          loading="lazy"\n          decoding="async"\n          alt="${o}"\n        >\n      `);let i="";return n.rsvp&&d[n.rsvp]&&(i=`<sub>${d[n.rsvp]}</sub>`),`\n      <a\n        class="reaction"\n        rel="nofollow ugc"\n        title="${o} ${r}"\n        href="${n[l]}"\n      >\n        ${s}\n        ${f[n["wm-property"]]||"💥"}\n        ${i}\n      </a>\n    `}function w(t){return t.substr(t.indexOf("//"))}function $(t){const n=[],e={};return t.forEach((function(t){const o=w(t.url);e[o]||(n.push(t),e[o]=!0)})),n}function g(t){let n=m(t.content.text);if(s){let t=n.replace(/\s+/g," ").split(" ",s+1);t.length>s&&(t[s-1]+="&hellip;",t=t.slice(0,s),n=t.join(" "))}return n}window.addEventListener("load",(async function(){const n=document.getElementById(r);if(!n)return;const s=[w(e)];o&&o.split("|").forEach((function(t){s.push(w(t))}));let p=`https://webmention.io/api/mentions.jf2?per-page=${i}&sort-by=${c}&sort-dir=${a}`;s.forEach((function(t){p+=`&target[]=${encodeURIComponent("http:"+t)}&target[]=${encodeURIComponent("https:"+t)}`}));let f={};try{const t=await window.fetch(apiUrl);t.status>=200&&t.status<300?f=await t.json():(console.error("Could not parse response"),new Error(t.statusText))}catch(t){throw console.error("Request failed",t),t}let d=[];const b=[];u&&(d=b);const y={"in-reply-to":d,"like-of":b,"repost-of":b,"bookmark-of":b,"follow-of":b,"mention-of":d,rsvp:d};f.children.forEach((function(t){const n=y[t["wm-property"]];n&&n.push(t)}));let k="";d.length>0&&d!==b&&(k=function(n){return`\n      <h2>${t("Responses")}</h2>\n      <ul class="comments">${n.map((n=>{const e=h(n,!0);let o=m(n.url.split("/")[2]);n.author&&n.author.name&&(o=m(n.author.name));const r=`<a class="source" rel="nofollow ugc" href="${n[l]}">${o}</a>`;let s="name",i=`(${t("mention")})`;return n.name?(s="name",i=n.name):n.content&&n.content.text&&(s="text",i=g(n)),`<li>${e} ${r} <span class="${s}">${i}</span></li>`})).join("")}</ul>\n    `}($(d)));let x="";b.length>0&&(x=`\n      <h2>' + t('Reactions') + '</h2>\n      <ul class="reacts">${$(b).map((t=>h(t))).join("")}</ul>\n    `),n.innerHTML=`${k}${x}`}))}();